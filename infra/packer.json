{
  "variables": {
    "cp_version": "6.1",
    "course": "ADM-SEC-RBAC",
    "version": "5.5.0-v0.8.0",
    "region": "us-west-2"
  },
  "builders": [{
    "type": "amazon-ebs",
    "profile": "default",
    "region": "{{user `region`}}",
    "source_ami_filter": {
      "filters": {
        "name": "CP {{user `cp_version`}}-base-*"
      },
      "owners": ["959853918561"],
      "most_recent": true
    },
    "instance_type": "c5.9xlarge",
    "ssh_username": "ubuntu",
    "ami_name": "{{user `course`}}-{{user `version`}}-{{isotime | clean_resource_name}}",
    "tags" : {
        "Name" : "{{user `course`}}",
        "Version": "{{user `version`}}"
      },
    "launch_block_device_mappings": [
      {
        "device_name": "/dev/sda1",
        "volume_size": 30,
        "volume_type": "gp2",
        "delete_on_termination": true
      }
    ]
    
    }],
    "provisioners": [
        {
          "type": "ansible",
          "playbook_file": "playbook.yml",
          "extra_arguments": ["-v"]
        }
    ]
  }